<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ezen.seo0308.bodar.Service_Bodar">
	<insert id="input">
		insert into BOARD0311(BNUM,WRITER,TITLE,CONTENT,GROUPS)
		values(BNUM0311_SQL.nextval, #{param1}, #{param2}, #{param3}, BNUM0311_SQL.currval)
	</insert>
	<select id="out" resultType="com.ezen.seo0308.bodar.Bodar_DTO">
		select BNUM,WRITER,TITLE,CONTENT,to_char(WRITERDAY,'yyyy-MM-dd')WRITERDAY,READCNT,GROUPS,STEP,INDENT from BOARD0311
		order by groups desc,step asc
	</select>
	<delete id="delete">
		delete from BOARD0311 where bnum = #{param1} 
	</delete>
	<select id="detail" resultType="com.ezen.seo0308.bodar.Bodar_DTO">
		select BNUM,WRITER,TITLE,CONTENT,to_char(WRITERDAY,'yyyy-MM-dd')WRITERDAY,READCNT,GROUPS,STEP,INDENT from BOARD0311 where bnum = #{param1}
	</select>
	<update id="readcntup">
		update BOARD0311 set READCNT = READCNT + 1 where bnum = #{param1}
	</update>
	<select id="replyview" resultType="com.ezen.seo0308.bodar.Bodar_DTO">
		select BNUM,WRITER,TITLE,CONTENT,to_char(WRITERDAY,'yyyy-MM-dd')WRITERDAY,READCNT,GROUPS,STEP,INDENT from BOARD0311 where bnum = #{param1}
	</select>
	<insert id="replysave">
		insert into BOARD0311(BNUM,WRITER,TITLE,CONTENT,GROUPS,STEP,INDENT) 
		values(BNUM0311_SQL.nextval,#{param1},#{param2},#{param3},#{param4},#{param5},#{param6})
	</insert>
	<update id="stepup">
		update BOARD0311 set step = step + 1 where groups= #{param1} and step > #{param2}
	</update>
	 <!-- 페이징처리에서 전체레코드수 구하기 -->
	<select id="total" resultType="int">
	   select count(*)from BOARD0311
	</select>
	<select id="page" resultType="com.ezen.seo0308.bodar.Bodar_DTO">
	   select * from (
	   select rownum rn,A.* from( 
	   select * from BOARD0311 order by groups DESC,step asc)A)
	   where rn between #{start} AND #{end}
	</select>
	
</mapper>